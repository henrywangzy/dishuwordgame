<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åœ°é¼ å•è¯æ¸¸æˆ - è¶£å‘³è‹±è¯­å­¦ä¹ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
        }

        /* æ¸¸æˆå®¹å™¨ */
        .game-container {
            width: 100%;
            max-width: 390px;
            height: 100vh;
            max-height: 844px;
            background: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(0,0,0,0.3);
        }

        /* é¡µé¢åŸºç¡€æ ·å¼ */
        .screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .screen.active {
            display: flex;
            opacity: 1;
            pointer-events: auto;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideInUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3); }
            50% { box-shadow: 0 4px 25px rgba(78, 205, 196, 0.5); }
        }

        /* æŒ‰é’®é€šç”¨æ ·å¼ */
        .btn {
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            touch-action: manipulation;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background: linear-gradient(135deg, #FF6B6B, #4ECDC4);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            animation: glow 2s ease-in-out infinite;
        }

        /* ============ é¦–é¡µæ ·å¼ ============ */
        #homeScreen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
            overflow: hidden;
        }

        .home-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 40px 20px 20px;
            animation: fadeIn 0.5s ease-out;
            overflow-y: auto;
        }

        .logo-area {
            text-align: center;
            margin-bottom: 30px;
            animation: slideInUp 0.6s ease-out;
        }

        .mole-logo {
            font-size: 100px;
            margin-bottom: 10px;
            animation: bounce 2s ease-in-out infinite;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
        }

        .game-title {
            font-size: 36px;
            font-weight: bold;
            background: linear-gradient(45deg, #FFD700, #FFA500, #FF6347);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 10px 0;
        }

        .game-subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 16px;
            margin-top: 5px;
        }

        .select-group {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .select-box {
            width: 100%;
            padding: 15px 20px;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 500;
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            border: 3px solid #FFD700;
            cursor: pointer;
        }

        .button-group {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .button-group .btn {
            width: 100%;
            padding: 16px;
            font-size: 18px;
        }

        .home-footer {
            margin-top: 20px;
            padding: 15px;
            text-align: center;
        }

        .publisher-info {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255,255,255,0.12);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            font-size: 14px;
            color: rgba(255,255,255,0.9);
        }

        /* ============ æ¸¸æˆé¡µé¢æ ·å¼ ============ */
        #gameScreen {
            background: linear-gradient(180deg, #87CEEB 0%, #90EE90 100%);
            position: relative;
        }


        /* è‰åœ°èƒŒæ™¯ */
        .grass-background {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 150px;
            background: linear-gradient(to top, #228B22, #32CD32);
            z-index: 0;
        }


        /* å¡ç‰Œç½‘æ ¼ */
        .cards-area {
            position: relative;
            z-index: 5;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 350px;
            aspect-ratio: 3/5;
        }

        /* åœ°é¼ æ´å¡ç‰Œ */
        .mole-card {
            position: relative;
            perspective: 1000px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .mole-card:active {
            transform: scale(0.95);
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        .mole-card.flipped .card-inner {
            transform: rotateY(180deg);
        }

        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .card-front {
            background: linear-gradient(135deg, #8B4513, #A0522D);
            border: 3px solid #654321;
        }

        .hole-emoji {
            font-size: 40px;
        }

        .card-back {
            background: linear-gradient(135deg, #FFE4B5, #FFDAB9);
            border: 3px solid #FFD700;
            transform: rotateY(180deg);
            padding: 5px;
        }

        .mole-emoji {
            font-size: 35px;
            margin-bottom: 3px;
        }

        .card-word {
            font-size: 15px;
            font-weight: bold;
            color: #333;
            text-align: center;
            word-break: break-word;
            line-height: 1.2;
        }

        /* æ­£ç¡®/é”™è¯¯åŠ¨ç”» */
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        @keyframes wrongShake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-10px); }
            40%, 80% { transform: translateX(10px); }
        }

        .mole-card.correct {
            animation: correctPulse 0.6s ease;
        }

        .mole-card.wrong {
            animation: wrongShake 0.5s ease;
        }

        .mole-card.matched .card-back {
            background: linear-gradient(135deg, #90EE90, #98FB98);
            border-color: #32CD32;
        }

        .mole-card.matched .mole-emoji::after {
            content: 'âœ“';
            position: absolute;
            font-size: 20px;
            color: #32CD32;
        }

        /* ============ æ¸¸æˆç»“æŸé¡µé¢ ============ */
        #gameOverScreen {
            background: linear-gradient(to bottom, #E3F2FD, #BBDEFB);
        }

        .game-over-content {
            flex: 1;
            padding: 30px 20px;
            overflow-y: auto;
            text-align: center;
        }

        .result-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: scaleIn 0.6s ease-out;
        }

        .result-title {
            font-size: 32px;
            color: #333;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .score-badge {
            background: linear-gradient(135deg, #FF5252, #FF1744);
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            display: inline-block;
            margin: 20px 0;
        }

        .score-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .score-value {
            font-size: 48px;
            font-weight: bold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 30px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .stat-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }

        .stat-card .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: #FF5252;
            margin: 5px 0;
        }

        .stat-card .stat-label {
            font-size: 14px;
            color: #666;
        }

        .game-over-buttons {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }

        /* ============ å•è¯æ€»ç»“æ ·å¼ ============ */
        .word-summary-section {
            width: 100%;
            margin: 20px 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .word-summary-box {
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .summary-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            text-align: left;
        }

        .word-summary-list {
            max-height: 120px;
            overflow-y: auto;
            text-align: left;
        }

        .word-summary-item {
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .word-summary-item:last-child {
            margin-bottom: 0;
        }

        .word-en {
            font-size: 15px;
            font-weight: bold;
            color: #FF6B6B;
        }

        .word-cn {
            font-size: 14px;
            color: #4ECDC4;
        }

        .no-words {
            text-align: center;
            color: #999;
            padding: 15px;
            font-size: 14px;
        }

        /* ============ æš‚åœå¼¹çª— ============ */
        .pause-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            justify-content: center;
            align-items: center;
        }

        .pause-modal.active {
            display: flex;
        }

        .pause-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            max-width: 300px;
        }

        .pause-title {
            font-size: 24px;
            color: #333;
            margin-bottom: 20px;
        }

        .pause-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* ============ å•è¯æœ¬é¡µé¢ ============ */
        #vocabularyScreen {
            background: white;
        }

        .vocab-header {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            padding: 15px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
        }

        .word-list {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .word-item {
            background: #f9f9f9;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .word-info {
            flex: 1;
        }

        .word-main {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .word-details {
            color: #666;
            font-size: 14px;
        }

        .play-word-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #4CAF50;
            color: white;
            border: none;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .play-word-btn:hover {
            background: #45a049;
            transform: scale(1.1);
        }

        /* å“åº”å¼ */
        @media (max-height: 700px) {
            .mole-logo { font-size: 70px; }
            .game-title { font-size: 28px; }
            .cards-grid { gap: 8px; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- å¼€å§‹é¡µ -->
        <div id="homeScreen" class="screen active">
            <div class="home-content">
                <div class="logo-area">
                    <div class="mole-logo">ğŸ¹</div>
                    <h1 class="game-title">åœ°é¼ å•è¯æ¸¸æˆ</h1>
                    <p class="game-subtitle">æ‰“åœ°é¼ å­¦å•è¯ï¼Œå¿«ä¹åˆé«˜æ•ˆï¼</p>
                </div>

                <div class="select-group">
                    <select id="gradeSelect" class="select-box">
                        <option value="1">1å¹´çº§ - åŸºç¡€è¯æ±‡</option>
                        <option value="2">2å¹´çº§ - è¿›é˜¶è¯æ±‡</option>
                        <option value="3">3å¹´çº§ - å¸¸ç”¨è¯æ±‡</option>
                        <option value="4">4å¹´çº§ - å®ç”¨è¯æ±‡</option>
                        <option value="5">5å¹´çº§ - é«˜çº§è¯æ±‡</option>
                        <option value="6">6å¹´çº§ - ç»¼åˆè¯æ±‡</option>
                    </select>

                    <select id="difficultySelect" class="select-box">
                        <option value="easy">ç®€å• - 2å¼ å¡ç‰‡ (2ç§’)</option>
                        <option value="medium">ä¸­ç­‰ - 3å¼ å¡ç‰‡ (2ç§’)</option>
                        <option value="hard">å›°éš¾ - 4å¼ å¡ç‰‡ (2ç§’)</option>
                    </select>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="startGame()">ğŸ® å¼€å§‹æ¸¸æˆ</button>
                    <button class="btn" style="background: linear-gradient(135deg, #11998e, #38ef7d); color: white;" onclick="showVocabulary()">ğŸ“š å•è¯æœ¬</button>
                </div>

                <div class="home-footer">
                    <div class="publisher-info">
                        <span>â­</span>
                        <span>åˆ¶ä½œbyå…¬ä¼—å·:æ³¡æ³¡å¦ˆå­¦AI</span>
                        <span>â­</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ¸¸æˆé¡µ -->
        <div id="gameScreen" class="screen">
            <!-- å¯¼èˆªæ  -->
            <div class="game-navbar" style="background: white; padding: 12px 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; justify-content: space-between; align-items: center;">
                <div class="navbar-left" style="display: flex; align-items: center; gap: 10px;">
                    <button class="btn-back" onclick="backToHome()" style="width: 32px; height: 32px; border-radius: 50%; border: none; background: #f0f0f0; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; font-size: 16px;">â¬…ï¸</button>
                    <div class="level-info" style="font-size: 14px; font-weight: bold; color: #42A5F5;">
                        <span id="gradeInfo">1å¹´çº§</span> - <span id="difficultyInfo">ç®€å•</span>
                    </div>
                </div>
                <div class="navbar-right" style="display: flex; align-items: center; gap: 12px;">
                    <span onclick="restartGame()" style="cursor: pointer; font-size: 20px; color: #666; padding: 4px;" title="é‡æ–°å¼€å§‹">ğŸ”„</span>
                    <span id="musicBtn" onclick="toggleSound()" style="cursor: pointer; font-size: 20px; color: #666; padding: 4px;" title="èƒŒæ™¯éŸ³ä¹">ğŸµ</span>
                    <span id="pauseBtn" onclick="togglePause()" style="cursor: pointer; font-size: 20px; color: #667eea; padding: 4px;" title="æš‚åœæ¸¸æˆ">â¸ï¸</span>
                </div>
            </div>

            <!-- ç›®æ ‡å•è¯ä¿¡æ¯æ  -->
            <div class="target-bar" style="background: #f8f9fa; padding: 10px 15px; display: flex; justify-content: center; align-items: center; gap: 25px; border-bottom: 1px solid #e0e0e0;">
                <div style="display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 12px; color: #999;">ğŸ¯</span>
                    <div class="target-word" id="targetWord" style="font-size: 20px; font-weight: bold; color: #FF6B6B;">Cat</div>
                    <div class="target-chinese" id="targetChinese" style="font-size: 16px; color: #4ECDC4;">çŒ«</div>
                </div>
                <div style="font-size: 14px; color: #666;">
                    <span>å¾—åˆ†: <span id="scoreDisplay" style="font-weight: bold; color: #FF6B6B;">0</span></span>
                </div>
                <div style="font-size: 14px; color: #666;">
                    <span>â± <span id="timerDisplay" style="font-weight: bold; color: #333;">90</span></span>
                </div>
            </div>

            <div class="cards-area">
                <div class="cards-grid" id="cardsGrid">
                    <!-- 15å¼ å¡ç‰ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <div class="grass-background"></div>
        </div>

        <!-- æš‚åœå¼¹çª—ï¼ˆå·²ç¦ç”¨ï¼Œä½¿ç”¨togglePauseæ›¿ä»£ï¼‰ -->
        <div class="pause-modal" id="pauseModal" style="display: none;">
            <div class="pause-content">
                <h2 class="pause-title">â¸ï¸ æ¸¸æˆæš‚åœ</h2>
                <div class="pause-buttons">
                    <button class="btn btn-primary" onclick="resumeGame()">â–¶ï¸ ç»§ç»­æ¸¸æˆ</button>
                    <button class="btn" style="background: #667eea; color: white;" onclick="backToHome()">ğŸ  è¿”å›é¦–é¡µ</button>
                </div>
            </div>
        </div>

        <!-- æ¸¸æˆç»“æŸé¡µ -->
        <div id="gameOverScreen" class="screen">
            <div class="game-over-content">
                <div class="result-icon">ğŸ‰</div>
                <h2 class="result-title" id="resultTitle">æ¸¸æˆç»“æŸï¼</h2>

                <div class="score-badge">
                    <div class="score-label">ä½ çš„å¾—åˆ†</div>
                    <div class="score-value" id="finalScore">0</div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">âœ…</div>
                        <div class="stat-value" id="correctCount">0</div>
                        <div class="stat-label">æ­£ç¡®</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">âŒ</div>
                        <div class="stat-value" id="wrongCount">0</div>
                        <div class="stat-label">é”™è¯¯</div>
                    </div>
                </div>

                <!-- å•è¯æ€»ç»“ -->
                <div class="word-summary-section">
                    <div class="word-summary-box">
                        <h3 class="summary-title">âœ… ç­”å¯¹çš„å•è¯</h3>
                        <div class="word-summary-list" id="correctWordsList"></div>
                    </div>
                    <div class="word-summary-box">
                        <h3 class="summary-title">âŒ ç­”é”™çš„å•è¯</h3>
                        <div class="word-summary-list" id="wrongWordsList"></div>
                    </div>
                </div>

                <div class="game-over-buttons">
                    <button class="btn btn-primary" onclick="restartGame()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                    <button class="btn" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white;" onclick="backToHome()">ğŸ  è¿”å›é¦–é¡µ</button>
                </div>
            </div>
        </div>

        <!-- å•è¯æœ¬é¡µ -->
        <div id="vocabularyScreen" class="screen">
            <div class="vocab-header">
                <button class="back-btn" onclick="backToHome()">â†</button>
                <h3>å•è¯æœ¬</h3>
                <select id="vocabGradeSelect" class="select-box" style="width: auto; padding: 8px 12px; font-size: 14px; background: white; color: #333;" onchange="updateVocabulary()">
                    <option value="1">1å¹´çº§</option>
                    <option value="2">2å¹´çº§</option>
                    <option value="3">3å¹´çº§</option>
                    <option value="4">4å¹´çº§</option>
                    <option value="5">5å¹´çº§</option>
                    <option value="6">6å¹´çº§</option>
                </select>
            </div>

            <div class="word-list" id="wordList">
                <!-- å•è¯åˆ—è¡¨åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <script>
        // ===== å•è¯æ•°æ®åº“ =====
        const wordDatabase = {
            1: [
                { word: 'Cat', chinese: 'çŒ«', example: 'The cat is sleeping.' },
                { word: 'Dog', chinese: 'ç‹—', example: 'My dog is friendly.' },
                { word: 'Bird', chinese: 'é¸Ÿ', example: 'Birds can fly.' },
                { word: 'Fish', chinese: 'é±¼', example: 'Fish live in water.' },
                { word: 'Apple', chinese: 'è‹¹æœ', example: 'The apple is red.' },
                { word: 'Banana', chinese: 'é¦™è•‰', example: 'I like bananas.' },
                { word: 'Red', chinese: 'çº¢è‰²', example: 'The apple is red.' },
                { word: 'Blue', chinese: 'è“è‰²', example: 'The sky is blue.' },
                { word: 'Green', chinese: 'ç»¿è‰²', example: 'Grass is green.' },
                { word: 'Yellow', chinese: 'é»„è‰²', example: 'The sun is yellow.' },
                { word: 'Book', chinese: 'ä¹¦', example: 'I read a book.' },
                { word: 'Pen', chinese: 'é’¢ç¬”', example: 'Write with a pen.' },
                { word: 'Ball', chinese: 'çƒ', example: 'Throw the ball.' },
                { word: 'Car', chinese: 'æ±½è½¦', example: 'The car is fast.' },
                { word: 'House', chinese: 'æˆ¿å­', example: 'I live in a house.' },
                { word: 'Tree', chinese: 'æ ‘', example: 'Trees are tall.' },
                { word: 'Sun', chinese: 'å¤ªé˜³', example: 'The sun is bright.' },
                { word: 'Moon', chinese: 'æœˆäº®', example: 'The moon is round.' },
                { word: 'Water', chinese: 'æ°´', example: 'Water is important.' },
                { word: 'Milk', chinese: 'ç‰›å¥¶', example: 'Drink your milk.' },
                { word: 'Run', chinese: 'è·‘', example: 'I can run fast.' },
                { word: 'Jump', chinese: 'è·³', example: 'Jump high!' },
                { word: 'Eat', chinese: 'åƒ', example: 'Eat your food.' },
                { word: 'Sleep', chinese: 'ç¡è§‰', example: 'Sleep well.' },
                { word: 'Happy', chinese: 'å¿«ä¹', example: 'I am happy.' }
            ],
            2: [
                { word: 'School', chinese: 'å­¦æ ¡', example: 'I go to school.' },
                { word: 'Teacher', chinese: 'è€å¸ˆ', example: 'My teacher is kind.' },
                { word: 'Student', chinese: 'å­¦ç”Ÿ', example: 'I am a student.' },
                { word: 'Friend', chinese: 'æœ‹å‹', example: 'You are my friend.' },
                { word: 'Family', chinese: 'å®¶åº­', example: 'I love my family.' },
                { word: 'Mother', chinese: 'å¦ˆå¦ˆ', example: 'Mother cooks dinner.' },
                { word: 'Father', chinese: 'çˆ¸çˆ¸', example: 'Father works hard.' },
                { word: 'Sister', chinese: 'å§å¦¹', example: 'My sister is tall.' },
                { word: 'Brother', chinese: 'å…„å¼Ÿ', example: 'My brother plays.' },
                { word: 'Breakfast', chinese: 'æ—©é¤', example: 'Eat breakfast.' },
                { word: 'Lunch', chinese: 'åˆé¤', example: 'Time for lunch.' },
                { word: 'Dinner', chinese: 'æ™šé¤', example: 'Dinner is ready.' },
                { word: 'Morning', chinese: 'æ—©æ™¨', example: 'Good morning!' },
                { word: 'Night', chinese: 'å¤œæ™š', example: 'Good night!' },
                { word: 'Today', chinese: 'ä»Šå¤©', example: 'Today is Monday.' },
                { word: 'Tomorrow', chinese: 'æ˜å¤©', example: 'See you tomorrow.' },
                { word: 'Yesterday', chinese: 'æ˜¨å¤©', example: 'Yesterday was fun.' },
                { word: 'Weather', chinese: 'å¤©æ°”', example: 'Nice weather today.' },
                { word: 'Hot', chinese: 'çƒ­çš„', example: 'Summer is hot.' },
                { word: 'Cold', chinese: 'å†·çš„', example: 'Winter is cold.' },
                { word: 'Big', chinese: 'å¤§çš„', example: 'The elephant is big.' },
                { word: 'Small', chinese: 'å°çš„', example: 'The mouse is small.' },
                { word: 'Fast', chinese: 'å¿«çš„', example: 'The car is fast.' },
                { word: 'Slow', chinese: 'æ…¢çš„', example: 'The turtle is slow.' },
                { word: 'Clean', chinese: 'å¹²å‡€çš„', example: 'Keep it clean.' }
            ],
            3: [
                { word: 'Computer', chinese: 'ç”µè„‘', example: 'Use the computer.' },
                { word: 'Internet', chinese: 'äº’è”ç½‘', example: 'Browse the internet.' },
                { word: 'English', chinese: 'è‹±è¯­', example: 'I study English.' },
                { word: 'Math', chinese: 'æ•°å­¦', example: 'Math is interesting.' },
                { word: 'Science', chinese: 'ç§‘å­¦', example: 'I love science.' },
                { word: 'History', chinese: 'å†å²', example: 'History is important.' },
                { word: 'Geography', chinese: 'åœ°ç†', example: 'Study geography.' },
                { word: 'Art', chinese: 'ç¾æœ¯', example: 'Art class is fun.' },
                { word: 'Music', chinese: 'éŸ³ä¹', example: 'I like music.' },
                { word: 'Sports', chinese: 'ä½“è‚²', example: 'Play sports daily.' },
                { word: 'Basketball', chinese: 'ç¯®çƒ', example: 'Play basketball.' },
                { word: 'Football', chinese: 'è¶³çƒ', example: 'Football is popular.' },
                { word: 'Swimming', chinese: 'æ¸¸æ³³', example: 'Swimming is healthy.' },
                { word: 'Reading', chinese: 'é˜…è¯»', example: 'Reading is fun.' },
                { word: 'Writing', chinese: 'å†™ä½œ', example: 'Practice writing.' },
                { word: 'Speaking', chinese: 'è¯´è¯', example: 'Speaking English.' },
                { word: 'Listening', chinese: 'å¬åŠ›', example: 'Improve listening.' },
                { word: 'Question', chinese: 'é—®é¢˜', example: 'Ask a question.' },
                { word: 'Answer', chinese: 'ç­”æ¡ˆ', example: 'Find the answer.' },
                { word: 'Problem', chinese: 'é—®é¢˜', example: 'Solve the problem.' },
                { word: 'Solution', chinese: 'è§£å†³æ–¹æ¡ˆ', example: 'Find a solution.' },
                { word: 'Understand', chinese: 'ç†è§£', example: 'I understand now.' },
                { word: 'Remember', chinese: 'è®°ä½', example: 'Remember this.' },
                { word: 'Forget', chinese: 'å¿˜è®°', example: 'Don\'t forget it.' },
                { word: 'Important', chinese: 'é‡è¦çš„', example: 'This is important.' }
            ],
            4: [
                { word: 'Environment', chinese: 'ç¯å¢ƒ', example: 'Protect the environment.' },
                { word: 'Technology', chinese: 'ç§‘æŠ€', example: 'Technology advances.' },
                { word: 'Communication', chinese: 'äº¤æµ', example: 'Good communication.' },
                { word: 'Information', chinese: 'ä¿¡æ¯', example: 'Share information.' },
                { word: 'Education', chinese: 'æ•™è‚²', example: 'Education matters.' },
                { word: 'Knowledge', chinese: 'çŸ¥è¯†', example: 'Gain knowledge.' },
                { word: 'Experience', chinese: 'ç»éªŒ', example: 'Learn from experience.' },
                { word: 'Practice', chinese: 'ç»ƒä¹ ', example: 'Practice makes perfect.' },
                { word: 'Success', chinese: 'æˆåŠŸ', example: 'Achieve success.' },
                { word: 'Failure', chinese: 'å¤±è´¥', example: 'Learn from failure.' },
                { word: 'Challenge', chinese: 'æŒ‘æˆ˜', example: 'Face the challenge.' },
                { word: 'Opportunity', chinese: 'æœºä¼š', example: 'Take the opportunity.' },
                { word: 'Decision', chinese: 'å†³å®š', example: 'Make a decision.' },
                { word: 'Choice', chinese: 'é€‰æ‹©', example: 'Good choice!' },
                { word: 'Responsibility', chinese: 'è´£ä»»', example: 'Take responsibility.' },
                { word: 'Freedom', chinese: 'è‡ªç”±', example: 'Value freedom.' },
                { word: 'Respect', chinese: 'å°Šé‡', example: 'Show respect.' },
                { word: 'Honest', chinese: 'è¯šå®', example: 'Be honest.' },
                { word: 'Patient', chinese: 'è€å¿ƒ', example: 'Be patient.' },
                { word: 'Confident', chinese: 'è‡ªä¿¡', example: 'Feel confident.' },
                { word: 'Creative', chinese: 'æœ‰åˆ›é€ åŠ›', example: 'Think creatively.' },
                { word: 'Positive', chinese: 'ç§¯æçš„', example: 'Stay positive.' },
                { word: 'Negative', chinese: 'æ¶ˆæçš„', example: 'Avoid negativity.' },
                { word: 'Possible', chinese: 'å¯èƒ½çš„', example: 'Everything is possible.' },
                { word: 'Impossible', chinese: 'ä¸å¯èƒ½çš„', example: 'Nothing is impossible.' }
            ],
            5: [
                { word: 'Adventure', chinese: 'å†’é™©', example: 'Go on an adventure.' },
                { word: 'Discovery', chinese: 'å‘ç°', example: 'Make a discovery.' },
                { word: 'Innovation', chinese: 'åˆ›æ–°', example: 'Support innovation.' },
                { word: 'Imagination', chinese: 'æƒ³è±¡åŠ›', example: 'Use your imagination.' },
                { word: 'Determination', chinese: 'å†³å¿ƒ', example: 'Show determination.' },
                { word: 'Perseverance', chinese: 'æ¯…åŠ›', example: 'Have perseverance.' },
                { word: 'Achievement', chinese: 'æˆå°±', example: 'Celebrate achievement.' },
                { word: 'Progress', chinese: 'è¿›æ­¥', example: 'Track your progress.' },
                { word: 'Development', chinese: 'å‘å±•', example: 'Support development.' },
                { word: 'Improvement', chinese: 'æ”¹è¿›', example: 'Continuous improvement.' },
                { word: 'Competition', chinese: 'ç«äº‰', example: 'Fair competition.' },
                { word: 'Cooperation', chinese: 'åˆä½œ', example: 'Team cooperation.' },
                { word: 'Leadership', chinese: 'é¢†å¯¼åŠ›', example: 'Show leadership.' },
                { word: 'Friendship', chinese: 'å‹è°Š', example: 'Value friendship.' },
                { word: 'Relationship', chinese: 'å…³ç³»', example: 'Build relationships.' },
                { word: 'Community', chinese: 'ç¤¾åŒº', example: 'Join the community.' },
                { word: 'Society', chinese: 'ç¤¾ä¼š', example: 'Contribute to society.' },
                { word: 'Culture', chinese: 'æ–‡åŒ–', example: 'Learn about culture.' },
                { word: 'Tradition', chinese: 'ä¼ ç»Ÿ', example: 'Respect traditions.' },
                { word: 'Festival', chinese: 'èŠ‚æ—¥', example: 'Celebrate the festival.' },
                { word: 'Celebration', chinese: 'åº†ç¥', example: 'Join the celebration.' },
                { word: 'Performance', chinese: 'è¡¨æ¼”', example: 'Watch the performance.' },
                { word: 'Exhibition', chinese: 'å±•è§ˆ', example: 'Visit the exhibition.' },
                { word: 'Museum', chinese: 'åšç‰©é¦†', example: 'Explore the museum.' },
                { word: 'Library', chinese: 'å›¾ä¹¦é¦†', example: 'Study in library.' }
            ],
            6: [
                { word: 'Democracy', chinese: 'æ°‘ä¸»', example: 'Support democracy.' },
                { word: 'Economy', chinese: 'ç»æµ', example: 'Study the economy.' },
                { word: 'Politics', chinese: 'æ”¿æ²»', example: 'Learn about politics.' },
                { word: 'Government', chinese: 'æ”¿åºœ', example: 'The government decides.' },
                { word: 'Organization', chinese: 'ç»„ç»‡', example: 'Join an organization.' },
                { word: 'Institution', chinese: 'æœºæ„', example: 'Work at institution.' },
                { word: 'Corporation', chinese: 'å…¬å¸', example: 'Big corporation.' },
                { word: 'Enterprise', chinese: 'ä¼ä¸š', example: 'Start an enterprise.' },
                { word: 'Management', chinese: 'ç®¡ç†', example: 'Learn management.' },
                { word: 'Strategy', chinese: 'ç­–ç•¥', example: 'Plan a strategy.' },
                { word: 'Philosophy', chinese: 'å“²å­¦', example: 'Study philosophy.' },
                { word: 'Psychology', chinese: 'å¿ƒç†å­¦', example: 'Understand psychology.' },
                { word: 'Sociology', chinese: 'ç¤¾ä¼šå­¦', example: 'Learn sociology.' },
                { word: 'Archaeology', chinese: 'è€ƒå¤å­¦', example: 'Study archaeology.' },
                { word: 'Astronomy', chinese: 'å¤©æ–‡å­¦', example: 'Explore astronomy.' },
                { word: 'Chemistry', chinese: 'åŒ–å­¦', example: 'Chemistry experiments.' },
                { word: 'Physics', chinese: 'ç‰©ç†', example: 'Physics laws.' },
                { word: 'Biology', chinese: 'ç”Ÿç‰©å­¦', example: 'Biology research.' },
                { word: 'Mathematics', chinese: 'æ•°å­¦', example: 'Advanced mathematics.' },
                { word: 'Literature', chinese: 'æ–‡å­¦', example: 'Read literature.' },
                { word: 'Architecture', chinese: 'å»ºç­‘', example: 'Study architecture.' },
                { word: 'Engineering', chinese: 'å·¥ç¨‹', example: 'Engineering design.' },
                { word: 'Medicine', chinese: 'åŒ»å­¦', example: 'Study medicine.' },
                { word: 'Agriculture', chinese: 'å†œä¸š', example: 'Modern agriculture.' },
                { word: 'Industry', chinese: 'å·¥ä¸š', example: 'Industrial development.' }
            ]
        };

        // ===== éŸ³æ•ˆç®¡ç† =====
        const sounds = {
            background: new Audio('./mp3/background.mp3'),
            gameover: new Audio('./mp3/gameover.mp3'),
            levelup: new Audio('./mp3/levelup.mp3'),
            welldown: new Audio('./mp3/welldown.mp3')
        };

        sounds.background.loop = true;
        sounds.background.volume = 0.3;

        let soundEnabled = true;

        function playSound(soundName) {
            if (soundEnabled && sounds[soundName]) {
                sounds[soundName].currentTime = 0;
                sounds[soundName].play().catch(e => console.log('éŸ³æ•ˆæ’­æ”¾å¤±è´¥:', e));
            }
        }

        function stopSound(soundName) {
            if (sounds[soundName]) {
                sounds[soundName].pause();
                sounds[soundName].currentTime = 0;
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            const soundBtn = document.getElementById('musicBtn');
            soundBtn.textContent = soundEnabled ? 'ğŸµ' : 'ğŸ”‡';

            if (!soundEnabled) {
                stopSound('background');
            } else {
                playSound('background');
            }
        }

        // ===== æ¸¸æˆçŠ¶æ€ =====
        let currentGrade = 1;
        let currentDifficulty = 'easy';
        let gameScore = 0;
        let correctCount = 0;
        let wrongCount = 0;
        let gameTimer = 60; // ä¿®æ”¹ä¸º60ç§’
        let timerInterval = null;
        let flipInterval = null;
        let autoFlipTimeout = null; // è‡ªåŠ¨ç¿»å›çš„å®šæ—¶å™¨
        let currentTargetWord = null;
        let cards = [];
        let gamePaused = false;
        let gameRunning = false;
        let correctWords = []; // è®°å½•ç­”å¯¹çš„å•è¯
        let wrongWords = []; // è®°å½•ç­”é”™çš„å•è¯

        // éš¾åº¦è®¾ç½®ï¼šå¡ç‰‡æ•°é‡å’Œåœç•™æ—¶é—´
        const difficultySettings = {
            easy: { cardCount: 2, displayTime: 2000 },    // 2å¼ å¡ç‰‡ï¼Œ2ç§’
            medium: { cardCount: 3, displayTime: 2000 },  // 3å¼ å¡ç‰‡ï¼Œ2ç§’
            hard: { cardCount: 4, displayTime: 2000 }     // 4å¼ å¡ç‰‡ï¼Œ2ç§’
        };

        const TARGET_SCORE = 100; // ç›®æ ‡åˆ†æ•°ï¼Œè¾¾åˆ°å³é€šå…³ï¼ˆå®é™…ä¸å†ä½¿ç”¨ï¼Œæ”¹ä¸ºæ—¶é—´é™åˆ¶ï¼‰

        // ===== å±å¹•åˆ‡æ¢ =====
        function switchScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // ===== TTSè¯­éŸ³æœ—è¯» =====
        function speakWord(word, chinese, example) {
            if (!window.speechSynthesis) return;

            speechSynthesis.cancel();

            const wordUtterance = new SpeechSynthesisUtterance(word);
            wordUtterance.lang = 'en-US';
            wordUtterance.rate = 0.9;

            wordUtterance.onend = () => {
                const chineseUtterance = new SpeechSynthesisUtterance(chinese);
                chineseUtterance.lang = 'zh-CN';
                chineseUtterance.rate = 0.8;

                if (example) {
                    chineseUtterance.onend = () => {
                        const exampleUtterance = new SpeechSynthesisUtterance(example);
                        exampleUtterance.lang = 'en-US';
                        exampleUtterance.rate = 0.9;
                        speechSynthesis.speak(exampleUtterance);
                    };
                }

                speechSynthesis.speak(chineseUtterance);
            };

            speechSynthesis.speak(wordUtterance);
        }

        // ===== å¼€å§‹æ¸¸æˆ =====
        function startGame() {
            currentGrade = parseInt(document.getElementById('gradeSelect').value);
            currentDifficulty = document.getElementById('difficultySelect').value;

            gameScore = 0;
            correctCount = 0;
            wrongCount = 0;
            gameTimer = 60; // 60ç§’å€’è®¡æ—¶
            gamePaused = false;
            gameRunning = true;
            correctWords = []; // æ¸…ç©ºç­”å¯¹è®°å½•
            wrongWords = []; // æ¸…ç©ºç­”é”™è®°å½•

            document.getElementById('scoreDisplay').textContent = gameScore;
            document.getElementById('timerDisplay').textContent = gameTimer;

            // æ›´æ–°å¹´çº§å’Œéš¾åº¦æ˜¾ç¤º
            const gradeNames = {1: '1å¹´çº§', 2: '2å¹´çº§', 3: '3å¹´çº§', 4: '4å¹´çº§', 5: '5å¹´çº§', 6: '6å¹´çº§'};
            const difficultyNames = {easy: 'ç®€å•', medium: 'ä¸­ç­‰', hard: 'å›°éš¾'};
            document.getElementById('gradeInfo').textContent = gradeNames[currentGrade];
            document.getElementById('difficultyInfo').textContent = difficultyNames[currentDifficulty];

            playSound('background');

            generateGameCards();
            selectNewTargetWord();
            switchScreen('gameScreen');
            startTimer();
            startCardFlipping();
        }

        // ===== ç”Ÿæˆæ¸¸æˆå¡ç‰Œï¼ˆä¿®å¤ï¼šæ¯å¼ å¡ç‰‡å›ºå®šå•è¯ï¼‰=====
        function generateGameCards() {
            const words = wordDatabase[currentGrade];
            const cardsGrid = document.getElementById('cardsGrid');
            cardsGrid.innerHTML = '';
            cards = [];

            // ä»å•è¯åº“ä¸­éšæœºé€‰æ‹©15ä¸ªå•è¯
            const selectedWords = [];
            const wordsCopy = [...words];
            for (let i = 0; i < 15; i++) {
                const randomIndex = Math.floor(Math.random() * wordsCopy.length);
                selectedWords.push(wordsCopy[randomIndex]);
                wordsCopy.splice(randomIndex, 1);
            }

            // ç”Ÿæˆ15å¼ å¡ç‰Œï¼Œæ¯å¼ å¡ç‰‡å›ºå®šä¸€ä¸ªå•è¯ï¼ˆè‹±æ–‡æˆ–ä¸­æ–‡éšæœºï¼‰
            for (let i = 0; i < 15; i++) {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'mole-card';
                cardDiv.dataset.index = i;

                const wordObj = selectedWords[i];
                const showEnglish = Math.random() < 0.5;

                cardDiv.innerHTML = `
                    <div class="card-inner">
                        <div class="card-front">
                            <div class="hole-emoji">ğŸ•³ï¸</div>
                        </div>
                        <div class="card-back">
                            <div class="mole-emoji">ğŸ¹</div>
                            <div class="card-word">${showEnglish ? wordObj.word : wordObj.chinese}</div>
                        </div>
                    </div>
                `;

                cardDiv.addEventListener('click', () => handleCardClick(i));
                cardsGrid.appendChild(cardDiv);

                // ä¿å­˜å¡ç‰‡ä¿¡æ¯ï¼ˆå›ºå®šå•è¯ï¼‰
                cards.push({
                    element: cardDiv,
                    wordObj: wordObj,
                    displayType: showEnglish ? 'english' : 'chinese',
                    displayText: showEnglish ? wordObj.word : wordObj.chinese,
                    flipped: false,
                    matched: false
                });
            }
        }

        // ===== é€‰æ‹©æ–°çš„ç›®æ ‡å•è¯ =====
        function selectNewTargetWord() {
            // ä»æœªåŒ¹é…çš„å¡ç‰‡ä¸­éšæœºé€‰ä¸€ä¸ªä½œä¸ºç›®æ ‡
            const unmatched = cards.filter(c => !c.matched);
            if (unmatched.length === 0) {
                // æ‰€æœ‰å¡ç‰‡éƒ½åŒ¹é…å®Œæˆï¼Œé‡æ–°æ´—ç‰Œ
                generateGameCards();
                return selectNewTargetWord();
            }

            const randomCard = unmatched[Math.floor(Math.random() * unmatched.length)];
            currentTargetWord = randomCard.wordObj;

            document.getElementById('targetWord').textContent = currentTargetWord.word;
            document.getElementById('targetChinese').textContent = currentTargetWord.chinese;

            speakWord(currentTargetWord.word, currentTargetWord.chinese);
        }

        // ===== å¡ç‰Œç¿»è½¬ç³»ç»Ÿï¼ˆä¿®å¤ï¼šå¿…é¡»åŒ…å«ç›®æ ‡å•è¯ï¼‰=====
        function flipNewCards() {
            // æ¸…é™¤ä¹‹å‰çš„è‡ªåŠ¨ç¿»å›å®šæ—¶å™¨
            if (autoFlipTimeout) {
                clearTimeout(autoFlipTimeout);
                autoFlipTimeout = null;
            }

            // å…ˆç¿»å›æ‰€æœ‰å·²ç¿»å¼€çš„å¡ç‰‡ï¼ˆåŒ…æ‹¬ç­”å¯¹çš„ï¼‰
            cards.forEach(card => {
                if (card.flipped) {
                    card.element.classList.remove('flipped', 'matched', 'correct');
                    card.flipped = false;
                    card.matched = false;
                }
            });

            // æ ¹æ®éš¾åº¦è®¾ç½®ç¿»å¼€ä¸åŒæ•°é‡çš„å¡ç‰‡
            const difficulty = difficultySettings[currentDifficulty];
            const numToFlip = difficulty.cardCount;

            // æ‰¾åˆ°ç›®æ ‡å•è¯å¯¹åº”çš„å¡ç‰‡
            const targetCard = cards.find(card =>
                card.wordObj.word === currentTargetWord.word
            );

            // å¦‚æœæ‰¾åˆ°äº†ç›®æ ‡å¡ç‰‡ï¼Œå¿…é¡»åŒ…å«å®ƒ
            const toFlip = [];
            if (targetCard) {
                toFlip.push(targetCard);
            }

            // ä»å…¶ä»–å¡ç‰‡ä¸­éšæœºé€‰æ‹©è¡¥é½æ•°é‡
            const otherCards = cards.filter(card => card !== targetCard);
            const shuffled = [...otherCards].sort(() => 0.5 - Math.random());
            const remaining = Math.min(numToFlip - toFlip.length, shuffled.length);
            toFlip.push(...shuffled.slice(0, remaining));

            // ç¿»å¼€å¡ç‰‡
            toFlip.forEach(card => {
                card.element.classList.add('flipped');
                card.flipped = true;
            });

            // è®¾ç½®è‡ªåŠ¨ç¿»å›å®šæ—¶å™¨ï¼ˆ2ç§’åè‡ªåŠ¨ç¿»å›ï¼‰
            if (!gamePaused && gameRunning) {
                autoFlipTimeout = setTimeout(() => {
                    if (!gamePaused && gameRunning) {
                        selectNewTargetWord();
                        flipNewCards();
                    }
                }, difficulty.displayTime);
            }
        }

        function startCardFlipping() {
            // åˆå§‹ç¿»å‡ºç¬¬ä¸€æ‰¹å¡ç‰‡
            flipNewCards();
        }

        // ===== å¤„ç†å¡ç‰Œç‚¹å‡» =====
        function handleCardClick(index) {
            const card = cards[index];

            // æ£€æŸ¥æ¸¸æˆçŠ¶æ€å’Œå¡ç‰‡çŠ¶æ€
            if (gamePaused || !gameRunning) return;
            if (!card.element.classList.contains('flipped')) return;
            if (card.matched) return; // é¿å…é‡å¤ç‚¹å‡»

            // æ£€æŸ¥æ˜¯å¦ç‚¹å‡»æ­£ç¡®
            const isCorrect = card.wordObj.word === currentTargetWord.word;

            if (isCorrect) {
                // æ­£ç¡®ï¼
                gameScore += 10;
                correctCount++;

                // è®°å½•ç­”å¯¹çš„å•è¯ï¼ˆé¿å…é‡å¤è®°å½•ï¼‰
                if (!correctWords.find(w => w.word === currentTargetWord.word)) {
                    correctWords.push({
                        word: currentTargetWord.word,
                        chinese: currentTargetWord.chinese
                    });
                }

                card.matched = true;
                card.element.classList.add('correct', 'matched');

                playSound('levelup');
                speakWord(currentTargetWord.word, currentTargetWord.chinese, currentTargetWord.example);

                // æ¸…é™¤è‡ªåŠ¨ç¿»å›å®šæ—¶å™¨
                if (autoFlipTimeout) {
                    clearTimeout(autoFlipTimeout);
                    autoFlipTimeout = null;
                }

                // ç­”å¯¹åç«‹å³ç¿»å‡ºæ–°å¡ç‰‡
                setTimeout(() => {
                    if (gameRunning && !gamePaused) {
                        selectNewTargetWord();
                        flipNewCards();
                    }
                }, 800);
            } else {
                // é”™è¯¯ï¼
                gameScore = Math.max(0, gameScore - 5);
                wrongCount++;

                // è®°å½•ç­”é”™çš„å•è¯ï¼ˆé¿å…é‡å¤è®°å½•ï¼‰
                if (!wrongWords.find(w => w.word === currentTargetWord.word)) {
                    wrongWords.push({
                        word: currentTargetWord.word,
                        chinese: currentTargetWord.chinese
                    });
                }

                card.element.classList.add('wrong');

                setTimeout(() => {
                    card.element.classList.remove('wrong');
                }, 500);
            }

            document.getElementById('scoreDisplay').textContent = gameScore;
        }

        // ===== è®¡æ—¶å™¨ =====
        function startTimer() {
            timerInterval = setInterval(() => {
                if (gamePaused || !gameRunning) return;

                gameTimer--;
                document.getElementById('timerDisplay').textContent = gameTimer;

                if (gameTimer <= 0) {
                    endGame(); // æ—¶é—´åˆ°
                }
            }, 1000);
        }

        // ===== æš‚åœ/ç»§ç»­æ¸¸æˆ =====
        function togglePause() {
            if (!gameRunning) return;

            gamePaused = !gamePaused;
            const pauseBtn = document.getElementById('pauseBtn');

            if (gamePaused) {
                // æš‚åœæ¸¸æˆ
                pauseBtn.textContent = 'â–¶ï¸';
                pauseBtn.title = 'ç»§ç»­æ¸¸æˆ';
                // æš‚åœèƒŒæ™¯éŸ³ä¹
                if (soundEnabled) {
                    sounds.background.pause();
                }
                // æ¸…é™¤è‡ªåŠ¨ç¿»å›å®šæ—¶å™¨
                if (autoFlipTimeout) {
                    clearTimeout(autoFlipTimeout);
                    autoFlipTimeout = null;
                }
            } else {
                // ç»§ç»­æ¸¸æˆ
                pauseBtn.textContent = 'â¸ï¸';
                pauseBtn.title = 'æš‚åœæ¸¸æˆ';
                // ç»§ç»­æ’­æ”¾èƒŒæ™¯éŸ³ä¹
                if (soundEnabled) {
                    sounds.background.play().catch(e => console.log('éŸ³ä¹æ’­æ”¾å¤±è´¥:', e));
                }
                // é‡æ–°å¼€å§‹ç¿»å¡ï¼ˆå¦‚æœæœ‰ç¿»å¼€çš„å¡ç‰‡ï¼‰
                const hasFlippedCards = cards.some(card => card.flipped);
                if (hasFlippedCards) {
                    const difficulty = difficultySettings[currentDifficulty];
                    autoFlipTimeout = setTimeout(() => {
                        if (!gamePaused && gameRunning) {
                            selectNewTargetWord();
                            flipNewCards();
                        }
                    }, difficulty.displayTime);
                }
            }
        }

        function pauseGame() {
            if (!gameRunning) return;
            gamePaused = true;
            document.getElementById('pauseModal').classList.add('active');
        }

        function resumeGame() {
            gamePaused = false;
            document.getElementById('pauseModal').classList.remove('active');
        }

        // ===== ç»“æŸæ¸¸æˆ =====
        function endGame() {
            gameRunning = false;
            clearInterval(timerInterval);
            clearInterval(flipInterval);
            if (autoFlipTimeout) {
                clearTimeout(autoFlipTimeout);
                autoFlipTimeout = null;
            }

            stopSound('background');
            playSound('gameover');

            document.getElementById('resultTitle').textContent = 'â° æ—¶é—´åˆ°ï¼';
            document.querySelector('.result-icon').textContent = 'ğŸ˜Š';
            document.getElementById('finalScore').textContent = gameScore;
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('wrongCount').textContent = wrongCount;

            // æ˜¾ç¤ºç­”å¯¹çš„å•è¯åˆ—è¡¨
            const correctList = document.getElementById('correctWordsList');
            correctList.innerHTML = '';
            if (correctWords.length > 0) {
                correctWords.forEach(word => {
                    const item = document.createElement('div');
                    item.className = 'word-summary-item';
                    item.innerHTML = `<span class="word-en">${word.word}</span> <span class="word-cn">${word.chinese}</span>`;
                    correctList.appendChild(item);
                });
            } else {
                correctList.innerHTML = '<div class="no-words">æ— </div>';
            }

            // æ˜¾ç¤ºç­”é”™çš„å•è¯åˆ—è¡¨
            const wrongList = document.getElementById('wrongWordsList');
            wrongList.innerHTML = '';
            if (wrongWords.length > 0) {
                wrongWords.forEach(word => {
                    const item = document.createElement('div');
                    item.className = 'word-summary-item';
                    item.innerHTML = `<span class="word-en">${word.word}</span> <span class="word-cn">${word.chinese}</span>`;
                    wrongList.appendChild(item);
                });
            } else {
                wrongList.innerHTML = '<div class="no-words">æ— </div>';
            }

            switchScreen('gameOverScreen');
        }

        // ===== é‡æ–°å¼€å§‹æ¸¸æˆ =====
        function restartGame() {
            stopSound('gameover');
            stopSound('welldown');
            startGame();
        }

        // ===== è¿”å›é¦–é¡µ =====
        function backToHome() {
            stopSound('background');
            stopSound('gameover');
            stopSound('welldown');
            clearInterval(timerInterval);
            clearInterval(flipInterval);
            if (autoFlipTimeout) {
                clearTimeout(autoFlipTimeout);
                autoFlipTimeout = null;
            }
            gamePaused = false;
            gameRunning = false;
            document.getElementById('pauseModal').classList.remove('active');
            switchScreen('homeScreen');
        }

        // ===== å•è¯æœ¬ =====
        function showVocabulary() {
            const grade = parseInt(document.getElementById('vocabGradeSelect').value);
            updateVocabulary();
            switchScreen('vocabularyScreen');
        }

        function updateVocabulary() {
            const grade = parseInt(document.getElementById('vocabGradeSelect').value);
            const words = wordDatabase[grade];
            const wordList = document.getElementById('wordList');

            wordList.innerHTML = '';

            words.forEach(wordObj => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-item';
                wordItem.innerHTML = `
                    <div class="word-info">
                        <div class="word-main">${wordObj.word}</div>
                        <div class="word-details">${wordObj.chinese}</div>
                        <div class="word-details">${wordObj.example}</div>
                    </div>
                    <button class="play-word-btn" onclick="speakWord('${wordObj.word}', '${wordObj.chinese}', '${wordObj.example.replace(/'/g, "\\'")}')">ğŸ”Š</button>
                `;
                wordList.appendChild(wordItem);
            });
        }

        // ===== é¡µé¢åŠ è½½å®Œæˆ =====
        window.addEventListener('load', () => {
            console.log('åœ°é¼ å•è¯æ¸¸æˆå·²åŠ è½½ï¼ç‰ˆæœ¬: v2.0 - ä¿®å¤ç‰ˆ');
        });
    </script>
</body>
</html>
